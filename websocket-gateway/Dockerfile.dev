# Development Dockerfile for WebSocket Gateway with Nodemon hot reloading
FROM node:18-alpine

# Set working directory
WORKDIR /app

# Install nodemon globally (also available as dev dependency)
RUN npm install -g nodemon

# Copy package files
COPY ./websocket-gateway/package*.json ./

# Install ALL dependencies (including devDependencies for nodemon)
RUN npm install

# Copy shared proto files for gRPC client (will be overridden by volume mount)
COPY ./shared/proto ./shared/proto

# Copy application files (will be overridden by volume mount)
COPY ./websocket-gateway/ .

# Expose WebSocket port
EXPOSE 3000

# Use nodemon for hot reloading (via npm run dev script)
CMD ["npm", "run", "dev"]